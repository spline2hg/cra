# Linting Report

- **Path**: `/workspaces/cra/Examples`
- **Generated on**: 2025-09-15 17:35:18

## LLM Summary

# 📈 Code Quality Intelligence Report

## 🚦 Executive Summary: Quick Action List

| Severity | File & Line Number(s) | Recommendation |
|----------|-----------------------|----------------|
| 🔴 **High** | `Examples/security_issues.py:27` , `Examples/user_api.py:10` |  Avoid `shell=True` in `subprocess.run` to prevent command injection. |
| 🔴 **High** | `Examples/security_issues.py:22`, `Examples/user_api.py:8` | Replace `pickle.load` with safer serialization methods like JSON to prevent insecure deserialization. |
| 🟡 **Medium** | `Examples/security_issues.py:55`, `Examples/user_api.py:24`, `Examples/helpers.js:19` | Avoid `eval()` and use safer alternatives like `ast.literal_eval()` or function mapping. |
| 🟡 **Medium** | `Examples/security_issues.py:49`, `Examples/user_api.py:19` | Use parameterized queries to prevent SQL injection. |
| 🟢 **Low** | Multiple files | Remove unused imports and variables to improve code clarity and reduce potential confusion. |

*This is a summary of the most pressing issues. Full details are provided below.*

---

## 🛠️ Actionable Recommendations & Fixes

### 🔴 High-Priority Issues

**1. Command Injection Vulnerability (subprocess.run with shell=True)**

- **File:** `Examples/security_issues.py:27`, `Examples/user_api.py:10`
- **Category:** Security
- **Impact:** Using `shell=True` in `subprocess.run` allows attackers to inject arbitrary commands into the shell, potentially compromising the system.
- **Why:** When `shell=True`, the command string is passed directly to the system's shell for execution. If the command string contains user-controlled input, an attacker can inject malicious commands by crafting input that includes shell metacharacters (e.g., `;`, `&&`, `||`).
- **Fix Example:**

  **Before**
  ```python
  # Examples/security_issues.py:27
  result = subprocess.run(f"ls {user_input}", shell=True, capture_output=True)

  # Examples/user_api.py:10
  subprocess.run(cmd, shell=True)
  ```

  **After**
  ```python
  # Examples/security_issues.py:27
  result = subprocess.run(["ls", user_input], shell=False, capture_output=True)

  # Examples/user_api.py:10
  subprocess.run(cmd.split(), shell=False) # Ensure cmd is properly sanitized
  ```
  **Explanation:** By passing the command and its arguments as a list to `subprocess.run` and setting `shell=False`, the command is executed directly without involving the shell. This prevents shell metacharacters from being interpreted, mitigating the command injection risk.  It's crucial to sanitize `cmd` before splitting it to prevent injection via the command itself.

**2. Insecure Deserialization (Pickle Usage)**

- **File:** `Examples/security_issues.py:22`, `Examples/user_api.py:8`
- **Category:** Security
- **Impact:** Using `pickle.load` to deserialize data from untrusted sources can lead to arbitrary code execution.
- **Why:** The `pickle` module is vulnerable to code injection because it can deserialize arbitrary Python objects, including malicious ones. An attacker can craft a pickled object that, when deserialized, executes arbitrary code on the system.
- **Fix Example:**

  **Before**
  ```python
  # Examples/security_issues.py:22
  self.data = pickle.load(f)

  # Examples/user_api.py:8
  users = pickle.load(f)
  ```

  **After**
  ```python
  # Examples/security_issues.py:22
  import json
  with open(self.config_file, "r") as f:
      self.data = json.load(f)

  # Examples/user_api.py:8
  import json
  with open("users.json", "r") as f:
      users = json.load(f)
  ```
  **Explanation:** Replace `pickle` with a safer serialization format like `JSON`.  JSON only supports simple data types and does not allow arbitrary code execution during deserialization.  Remember to update the file extension and serialization logic accordingly.

### 🟡 Medium-Priority Issues

**1. Code Injection Vulnerability (Eval Usage)**

- **File:** `Examples/security_issues.py:55`, `Examples/user_api.py:24`, `Examples/helpers.js:19`
- **Category:** Security
- **Impact:** Using `eval` allows attackers to execute arbitrary code, potentially compromising the system.
- **Why:** The `eval()` function executes a string as Python code. If the string contains user-controlled input, an attacker can inject malicious code by crafting input that includes arbitrary Python statements.
- **Fix Example:**

  **Before**
  ```python
  # Examples/security_issues.py:55
  return eval(user_code)

  # Examples/user_api.py:24
  result = eval(data)

  # Examples/helpers.js:19
  return eval(code);
  ```

  **After**
  ```python
  # Examples/security_issues.py:55
  import ast
  try:
      result = ast.literal_eval(user_code)
  except (ValueError, SyntaxError):
      result = None  # Or handle the error appropriately

  # Examples/user_api.py:24
  # Replace eval with a safer alternative, e.g., a dictionary lookup
  # Assuming 'data' is a key in a predefined dictionary of functions
  function_map = {
      "function1": some_function,
      "function2": another_function,
  }
  result = function_map.get(data, None) # Handle the case where 'data' is not a valid key

  # Examples/helpers.js:19
  // Replace eval with a safer alternative, e.g., a dictionary lookup
  const functionMap = {
      "function1": () => { /* ... */ },
      "function2": () => { /* ... */ },
  };
  const result = functionMap[code] || null; // Handle invalid code
  return result;
  ```
  **Explanation:** Replace `eval` with safer alternatives.  `ast.literal_eval` can safely evaluate strings containing Python literals (strings, numbers, booleans, lists, dictionaries, etc.). For more complex scenarios, use a dictionary to map user input to predefined functions, ensuring that only authorized code is executed.  In JavaScript, a similar function map approach can be used.

**2. SQL Injection Vulnerability (String-based Query Construction)**

- **File:** `Examples/security_issues.py:49`, `Examples/user_api.py:19`
- **Category:** Security
- **Impact:** Constructing SQL queries by concatenating strings with user input can lead to SQL injection vulnerabilities.
- **Why:** If user input is not properly sanitized, an attacker can inject malicious SQL code into the query, potentially gaining unauthorized access to the database.
- **Fix Example:**

  **Before**
  ```python
  # Examples/security_issues.py:49
  query = f"SELECT * FROM users WHERE id = {user_id}"

  # Examples/user_api.py:19
  query = f"SELECT * FROM users WHERE id = {user_id}"
  ```

  **After**
  ```python
  # Examples/security_issues.py:49
  # Assuming you are using a database library like psycopg2 or sqlite3
  cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))
  query = cursor.fetchone()

  # Examples/user_api.py:19
  # Assuming you are using a database library like psycopg2 or sqlite3
  cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))
  query = cursor.fetchone()
  ```
  **Explanation:** Use parameterized queries (also known as prepared statements). Parameterized queries separate the SQL code from the user input, preventing the database from interpreting the input as part of the query. The database library handles the proper escaping and quoting of the input, ensuring that it is treated as data rather than code.

### 🟢 Low-Priority Issues

**1. Unused Imports and Variables**

- **File:** `Examples/billing.py:1`, `Examples/security_issues.py:3, 6`, `Examples/user_api.py:3`, `Examples/helpers.js`, `Examples/index.js`
- **Category:** Code Smell
- **Impact:** Unused imports and variables clutter the code, making it harder to read and understand. They can also lead to confusion and potential errors.
- **Why:** Unused code increases the cognitive load on developers and can obscure the intent of the code.
- **Fix Example:**

  **Before**
  ```python
  # Examples/security_issues.py
  import os  # Unused
  from typing import Any, Dict  # Unused
  ```

  **After**
  ```python
  # Examples/security_issues.py
  # Remove unused imports
  ```
  **Explanation:** Simply remove the unused imports and variables. Most IDEs and code editors can automatically detect unused code.

**2. Trailing Whitespace**

- **File:** `Examples/user_api.py`
- **Category:** Code Style
- **Impact:** Trailing whitespace can cause minor visual inconsistencies and annoyances.
- **Why:** It's a minor code style issue that can be easily fixed.
- **Fix Example:**

  **Before**
  ```python
  # Examples/user_api.py
  cmd = f"echo {username}"           
  ```

  **After**
  ```python
  # Examples/user_api.py
  cmd = f"echo {username}"
  ```
  **Explanation:** Remove the trailing whitespace. Most IDEs and code editors can automatically remove trailing whitespace on save.

**3. Missing Docstrings**

- **File:** `Examples/billing.py`, `Examples/user_api.py`
- **Category:** Code Style
- **Impact:** Missing docstrings make it harder to understand the purpose and usage of modules, classes, and functions.
- **Why:** Docstrings are essential for code documentation and maintainability.
- **Fix Example:**

  **Before**
  ```python
  # Examples/billing.py
  def calculate_discount(...):
      # No docstring
      ...
  ```

  **After**
  ```python
  # Examples/billing.py
  def calculate_discount(...):
      """
      Calculates the discount based on customer, product, and other factors.

      Args:
          customer: The customer object.
          product: The product object.
          ...

      Returns:
          The discount amount.
      """
      ...
  ```
  **Explanation:** Add docstrings to all modules, classes, and functions, explaining their purpose, arguments, and return values.

📊 Overall Code Quality Assessment

### Complexity Analysis

| Method / Function | File | Complexity Score | Rating |
|-------------------|------|------------------|--------|
| calculate_discount | Examples/billing.py | 7 | 🟡 Medium |
| process_order | Examples/billing.py | 6 | 🟡 Medium |
| unused_helper | Examples/billing.py | 1 | 🟢 Low |
| login | Examples/user_api.py | 1 | 🟢 Low |
| render_user | Examples/user_api.py | 1 | 🟢 Low |
| get_user_data | Examples/user_api.py | 1 | 🟢 Low |
| process_data | Examples/user_api.py | 1 | 🟢 Low |
| SecurityProblems | Examples/security_issues.py | 2 | 🟢 Low |
| SecurityProblems.broad_exception_handling | Examples/security_issues.py | 2 | 🟢 Low |
| sql_injection_risk | Examples/security_issues.py | 1 | 🟢 Low |
| eval_usage | Examples/security_issues.py | 1 | 🟢 Low |
| SecurityProblems.__init__ | Examples/security_issues.py | 1 | 🟢 Low |
| SecurityProblems.load_config_insecure | Examples/security_issues.py | 1 | 🟢 Low |
| SecurityProblems.execute_command_insecure | Examples/security_issues.py | 1 | 🟢 Low |
| SecurityProblems.get_password_insecure | Examples/security_issues.py | 1 | 🟢 Low |

Scores > 5 are considered medium and may require refactoring.

### Recurring Patterns & Themes

1.  **Security Vulnerabilities:** The codebase exhibits several security vulnerabilities, including command injection, insecure deserialization, SQL injection, and `eval` usage. These vulnerabilities pose a significant risk to the system and should be addressed immediately.
2.  **Lack of Input Validation:** The code lacks proper input validation, making it susceptible to various attacks.
3.  **Code Style Issues:** The codebase contains several code style issues, such as trailing whitespace, missing docstrings, and inconsistent formatting. These issues reduce code readability and maintainability.
4.  **Unused Code:** The codebase contains several unused imports and variables, cluttering the code and potentially leading to confusion.

### General Observations & Strengths

The codebase has several areas that need improvement, particularly in security and code style. The presence of multiple security vulnerabilities is a major concern and should be addressed immediately. The code style issues, while less critical, should also be addressed to improve code readability and maintainability. The Radon Maintainability Index is generally good, but the complexity of some functions in `billing.py` should be reviewed.

---


## Python Linting Results

## Pylint Output

```
************* Module user_api
Examples/user_api.py:7:41: C0303: Trailing whitespace (trailing-whitespace)
Examples/user_api.py:9:28: C0303: Trailing whitespace (trailing-whitespace)
Examples/user_api.py:14:38: C0303: Trailing whitespace (trailing-whitespace)
Examples/user_api.py:28:0: C0304: Final newline missing (missing-final-newline)
Examples/user_api.py:1:0: C0114: Missing module docstring (missing-module-docstring)
Examples/user_api.py:10:4: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)
Examples/user_api.py:13:0: C0116: Missing function or method docstring (missing-function-docstring)
Examples/user_api.py:17:0: C0116: Missing function or method docstring (missing-function-docstring)
Examples/user_api.py:22:0: C0116: Missing function or method docstring (missing-function-docstring)
Examples/user_api.py:24:13: W0123: Use of eval (eval-used)
Examples/user_api.py:3:0: W0611: Unused datetime imported from datetime (unused-import)
************* Module security_issues
Examples/security_issues.py:24:39: W0621: Redefining name 'user_input' from outer scope (line 68) (redefined-outer-name)
Examples/security_issues.py:27:17: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)
Examples/security_issues.py:42:15: W0718: Catching too general exception Exception (broad-exception-caught)
Examples/security_issues.py:39:17: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)
Examples/security_issues.py:41:23: E1101: Instance of 'SecurityProblems' has no 'process_data' member (no-member)
Examples/security_issues.py:55:11: W0123: Use of eval (eval-used)
Examples/security_issues.py:3:0: W0611: Unused import os (unused-import)
Examples/security_issues.py:6:0: W0611: Unused Any imported from typing (unused-import)
Examples/security_issues.py:6:0: W0611: Unused Dict imported from typing (unused-import)
************* Module billing
Examples/billing.py:45:0: C0304: Final newline missing (missing-final-newline)
Examples/billing.py:1:0: C0114: Missing module docstring (missing-module-docstring)
Examples/billing.py:1:0: R0913: Too many arguments (7/5) (too-many-arguments)
Examples/billing.py:1:0: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)
Examples/billing.py:4:4: R1702: Too many nested blocks (6/5) (too-many-nested-blocks)
Examples/billing.py:1:33: W0613: Unused argument 'product' (unused-argument)
Examples/billing.py:44:0: C0116: Missing function or method docstring (missing-function-docstring)

------------------------------------------------------------------
Your code has been rated at 6.48/10 (previous run: 6.48/10, +0.00)


```

## Flake8 Output

```
/workspaces/cra/Examples/billing.py:25:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/billing.py:44:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/billing.py:45:43: W292 no newline at end of file
/workspaces/cra/Examples/security_issues.py:1:80: E501 line too long (85 > 79 characters)
/workspaces/cra/Examples/security_issues.py:3:1: F401 'os' imported but unused
/workspaces/cra/Examples/security_issues.py:6:1: F401 'typing.Any' imported but unused
/workspaces/cra/Examples/security_issues.py:6:1: F401 'typing.Dict' imported but unused
/workspaces/cra/Examples/security_issues.py:26:9: E265 block comment should start with '# '
/workspaces/cra/Examples/security_issues.py:27:80: E501 line too long (84 > 79 characters)
/workspaces/cra/Examples/user_api.py:3:1: F401 'datetime.datetime' imported but unused
/workspaces/cra/Examples/user_api.py:5:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/user_api.py:7:42: W291 trailing whitespace
/workspaces/cra/Examples/user_api.py:9:29: W291 trailing whitespace
/workspaces/cra/Examples/user_api.py:13:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/user_api.py:14:20: E201 whitespace after '{'
/workspaces/cra/Examples/user_api.py:14:30: E202 whitespace before '}'
/workspaces/cra/Examples/user_api.py:14:39: W291 trailing whitespace
/workspaces/cra/Examples/user_api.py:17:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/user_api.py:22:1: E302 expected 2 blank lines, found 1
/workspaces/cra/Examples/user_api.py:28:1: E305 expected 2 blank lines after class or function definition, found 1
/workspaces/cra/Examples/user_api.py:28:32: W291 trailing whitespace
/workspaces/cra/Examples/user_api.py:28:33: W292 no newline at end of file

```

## Bandit Output

```
Run started:2025-09-15 17:35:21.247223

Test results:
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle
   Location: /workspaces/cra/Examples/security_issues.py:4:0
3	import os
4	import pickle
5	import subprocess

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: /workspaces/cra/Examples/security_issues.py:5:0
4	import pickle
5	import subprocess
6	from typing import Any, Dict

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: /workspaces/cra/Examples/security_issues.py:22:24
21	        with open(self.config_file, "rb") as f:
22	            self.data = pickle.load(f)
23	

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: /workspaces/cra/Examples/security_issues.py:27:17
26	        #subprocess with shell=True
27	        result = subprocess.run(f"ls {user_input}", shell=True, capture_output=True)
28	        return result.stdout

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'admin123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: /workspaces/cra/Examples/security_issues.py:33:19
32	        # Hardcoded password
33	        password = "admin123"
34	        return password

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: /workspaces/cra/Examples/security_issues.py:49:14
48	    """Function with potential SQL injection."""
49	    query = f"SELECT * FROM users WHERE id = {user_id}"
50	    return query

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: /workspaces/cra/Examples/security_issues.py:55:11
54	    """Dangerous eval usage."""
55	    return eval(user_code)
56	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'hardcoded-secret-key-123'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: /workspaces/cra/Examples/security_issues.py:59:13
58	# Global variables that could be security risks
59	SECRET_KEY = "hardcoded-secret-key-123"
60	API_TOKEN = "sk-1234567890abcdef"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'sk-1234567890abcdef'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: /workspaces/cra/Examples/security_issues.py:60:12
59	SECRET_KEY = "hardcoded-secret-key-123"
60	API_TOKEN = "sk-1234567890abcdef"
61	

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle
   Location: /workspaces/cra/Examples/user_api.py:1:0
1	import pickle
2	import subprocess
3	from datetime import datetime

--------------------------------------------------
>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.
   Severity: Low   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b404-import-subprocess
   Location: /workspaces/cra/Examples/user_api.py:2:0
1	import pickle
2	import subprocess
3	from datetime import datetime

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: /workspaces/cra/Examples/user_api.py:8:16
7	    with open("users.pickle", "rb") as f:   
8	        users = pickle.load(f)
9	    cmd = f"echo {username}"           

--------------------------------------------------
>> Issue: [B602:subprocess_popen_with_shell_equals_true] subprocess call with shell=True identified, security issue.
   Severity: High   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b602_subprocess_popen_with_shell_equals_true.html
   Location: /workspaces/cra/Examples/user_api.py:10:4
9	    cmd = f"echo {username}"           
10	    subprocess.run(cmd, shell=True)
11	    return users.get(username) == password

--------------------------------------------------
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Low
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: /workspaces/cra/Examples/user_api.py:19:14
18	    # SQL injection vulnerability
19	    query = f"SELECT * FROM users WHERE id = {user_id}"
20	    return query

--------------------------------------------------
>> Issue: [B307:blacklist] Use of possibly insecure function - consider using safer ast.literal_eval.
   Severity: Medium   Confidence: High
   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b307-eval
   Location: /workspaces/cra/Examples/user_api.py:24:13
23	    # Using eval - security risk
24	    result = eval(data)
25	    return result

--------------------------------------------------

Code scanned:
	Total lines of code: 108
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 7
		Medium: 6
		High: 2
	Total issues (by confidence):
		Undefined: 0
		Low: 2
		Medium: 3
		High: 10
Files skipped (0):

```

## Vulture Output (Dead Code Detection)

```
Examples/billing.py:1: unused variable 'product' (100% confidence)
Examples/security_issues.py:3: unused import 'os' (90% confidence)
Examples/security_issues.py:6: unused import 'Any' (90% confidence)
Examples/security_issues.py:6: unused import 'Dict' (90% confidence)
Examples/user_api.py:3: unused import 'datetime' (90% confidence)

```

## Radon Complexity Analysis

```
/workspaces/cra/Examples/user_api.py
    F 5:0 login - A (1)
    F 13:0 render_user - A (1)
    F 17:0 get_user_data - A (1)
    F 22:0 process_data - A (1)
/workspaces/cra/Examples/security_issues.py
    C 11:0 SecurityProblems - A (2)
    M 36:4 SecurityProblems.broad_exception_handling - A (2)
    F 47:0 sql_injection_risk - A (1)
    F 53:0 eval_usage - A (1)
    M 14:4 SecurityProblems.__init__ - A (1)
    M 18:4 SecurityProblems.load_config_insecure - A (1)
    M 24:4 SecurityProblems.execute_command_insecure - A (1)
    M 30:4 SecurityProblems.get_password_insecure - A (1)
/workspaces/cra/Examples/billing.py
    F 1:0 calculate_discount - B (7)
    F 25:0 process_order - B (6)
    F 44:0 unused_helper - A (1)

```

## Radon Maintainability Index

```
/workspaces/cra/Examples/user_api.py - A (88.19)
/workspaces/cra/Examples/security_issues.py - A (77.88)
/workspaces/cra/Examples/billing.py - A (55.62)

```

---

## JavaScript Linting Results

## ESLint Output

```
[{"filePath":"/workspaces/cra/Examples/helpers.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'process' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'unsafeRedirect' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'executeCode' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":21},{"ruleId":"security/detect-eval-with-expression","severity":2,"message":"eval with argument of type Identifier","line":19,"column":12,"nodeType":"CallExpression","endLine":19,"endColumn":22},{"ruleId":"no-unused-vars","severity":2,"message":"'renderUserData' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'calculateDiscount' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'unusedHelper' is defined but never used.","line":59,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":22}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"function process(x) {\n    if (x > 0) {\n        if (x < 10) {\n            if (x % 2 === 0) {\n                if (x !== 4) {\n                    console.log(x);\n                }\n            }\n        }\n    }\n}\n\n// Security issues\nfunction unsafeRedirect(url) {\n    window.location.href = url;  // SEC: open redirect\n}\n\nfunction executeCode(code) {\n    return eval(code);  // SEC: eval usage\n}\n\n// XSS vulnerability\nfunction renderUserData(user) {\n    document.getElementById('user').innerHTML = user.name;  // SEC: XSS\n}\n\n// Complex function with too many nested conditions\nfunction calculateDiscount(customer, product, qty, season, coupon, tax, shipping) {\n    let discount = 0;\n    if (customer.isVip) {\n        if (season === \"summer\") {\n            if (coupon) {\n                if (qty > 10) {\n                    if (tax < 0.2) {\n                        if (shipping === \"free\") {\n                            discount = 15;\n                        } else {\n                            discount = 10;\n                        }\n                    } else {\n                        discount = 5;\n                    }\n                } else {\n                    discount = 3;\n                }\n            } else {\n                discount = 2;\n            }\n        } else {\n            discount = 1;\n        }\n    } else {\n        discount = 0;\n    }\n    return discount;\n}\n\n// Unused function\nfunction unusedHelper() {\n    return \"This function is never called\";\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"/workspaces/cra/Examples/index.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'handleUser' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":20},{"ruleId":"no-unused-vars","severity":2,"message":"'processOrderA' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":23},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":21,"column":13,"nodeType":"MemberExpression","endLine":21,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":22,"column":17,"nodeType":"MemberExpression","endLine":22,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":23,"column":26,"nodeType":"MemberExpression","endLine":23,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":25,"column":26,"nodeType":"MemberExpression","endLine":25,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":28,"column":22,"nodeType":"MemberExpression","endLine":28,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'processOrderB' is defined but never used.","line":34,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":23},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":37,"column":13,"nodeType":"MemberExpression","endLine":37,"endColumn":21},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":38,"column":17,"nodeType":"MemberExpression","endLine":38,"endColumn":25},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":39,"column":26,"nodeType":"MemberExpression","endLine":39,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":41,"column":26,"nodeType":"MemberExpression","endLine":41,"endColumn":34},{"ruleId":"security/detect-object-injection","severity":2,"message":"Generic Object Injection Sink","line":44,"column":22,"nodeType":"MemberExpression","endLine":44,"endColumn":30},{"ruleId":"no-unused-vars","severity":2,"message":"'calculateTotal' is defined but never used.","line":51,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":51,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'unusedVar' is assigned a value but never used.","line":53,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":20}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const userInput = location.hash.slice(1);\ndocument.body.innerHTML = userInput;\n\nif (userInput == \"admin\") {\n    console.log(\"admin\");\n}\n\nfunction handleUser(data) {\n    const html = `<div>${data.name}</div>`;\n    document.body.innerHTML = html;\n    console.log(\"user rendered\");\n}\n\n// Security issue - using eval\neval(\"console.log('This is dangerous')\");\n\n// Duplicate code example\nfunction processOrderA(items) {\n    let total = 0;\n    for (let i = 0; i < items.length; i++) {\n        if (items[i].category === \"electronics\") {\n            if (items[i].price > 1000) {\n                total += items[i].price * 0.8;\n            } else {\n                total += items[i].price * 0.9;\n            }\n        } else {\n            total += items[i].price;\n        }\n    }\n    return total;\n}\n\nfunction processOrderB(items) {\n    let total = 0;\n    for (let i = 0; i < items.length; i++) {\n        if (items[i].category === \"electronics\") {\n            if (items[i].price > 1000) {\n                total += items[i].price * 0.8;\n            } else {\n                total += items[i].price * 0.9;\n            }\n        } else {\n            total += items[i].price;\n        }\n    }\n    return total;\n}\n\n// Unused variable\nfunction calculateTotal(price) {\n    const tax = 0.08;\n    const unusedVar = \"This is not used\";\n    return price + (price * tax);\n}","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]

```

## Semgrep Output

```
{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["/workspaces/cra/Examples/billing.py", "/workspaces/cra/Examples/helpers.js", "/workspaces/cra/Examples/index.js", "/workspaces/cra/Examples/security_issues.py", "/workspaces/cra/Examples/user_api.py"]}, "results": [{"check_id": "javascript.browser.security.eval-detected.eval-detected", "end": {"col": 22, "line": 19, "offset": 368}, "extra": {"engine_kind": "OSS", "fingerprint": "eaa7ba40eb2bcbbad6040494ec68293b2136e2b127f9ced03af3d3ef43a452c5746c63ad533a225f5b9d30086650cbc5a80d59744421224ca83a78bd87b4d31a_0", "is_ignored": false, "lines": "    return eval(code);  // SEC: eval usage", "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.", "metadata": {"asvs": {"control_id": "5.2.4 Dynamic Code Execution Features", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing", "section": "V5 Validation, Sanitization and Encoding", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9238, "rule_id": "GdU7dw", "rv_id": 945778, "url": "https://semgrep.dev/playground/r/o5TZePx/javascript.browser.security.eval-detected.eval-detected", "version_id": "o5TZePx"}}, "shortlink": "https://sg.run/7ope", "source": "https://semgrep.dev/r/javascript.browser.security.eval-detected.eval-detected", "subcategory": ["audit"], "technology": ["browser"], "vulnerability_class": ["Code Injection"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/helpers.js", "start": {"col": 12, "line": 19, "offset": 358}}, {"check_id": "javascript.browser.security.insecure-document-method.insecure-document-method", "end": {"col": 59, "line": 24, "offset": 504}, "extra": {"engine_kind": "OSS", "fingerprint": "f2f788b169867bedc2d7d946423fe0bc7c15cbf0cee62ac40de00468da738e8e59c2b8615c1dfd3a84f67d4689092bfa0105545471e1f1568947232051b6d780_0", "is_ignored": false, "lines": "    document.getElementById('user').innerHTML = user.name;  // SEC: XSS", "message": "User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9239, "rule_id": "ReUg41", "rv_id": 945779, "url": "https://semgrep.dev/playground/r/zyTlk9P/javascript.browser.security.insecure-document-method.insecure-document-method", "version_id": "zyTlk9P"}}, "shortlink": "https://sg.run/LwA9", "source": "https://semgrep.dev/r/javascript.browser.security.insecure-document-method.insecure-document-method", "subcategory": ["audit"], "technology": ["browser"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$EL": {"abstract_content": "document.getElementById('user')", "end": {"col": 36, "line": 24, "offset": 481}, "start": {"col": 5, "line": 24, "offset": 450}}, "$HTML": {"abstract_content": "user.name", "end": {"col": 58, "line": 24, "offset": 503}, "start": {"col": 49, "line": 24, "offset": 494}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/helpers.js", "start": {"col": 5, "line": 24, "offset": 450}}, {"check_id": "javascript.browser.security.insecure-document-method.insecure-document-method", "end": {"col": 37, "line": 2, "offset": 78}, "extra": {"engine_kind": "OSS", "fingerprint": "af5fed520369662cc2a8394090b04886aa8941572cdc21f09b25e27882287ff7cf98b6898c4f5431876347524000cafc145d108dab8575b1d99cbaddc3726e72_0", "is_ignored": false, "lines": "document.body.innerHTML = userInput;", "message": "User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9239, "rule_id": "ReUg41", "rv_id": 945779, "url": "https://semgrep.dev/playground/r/zyTlk9P/javascript.browser.security.insecure-document-method.insecure-document-method", "version_id": "zyTlk9P"}}, "shortlink": "https://sg.run/LwA9", "source": "https://semgrep.dev/r/javascript.browser.security.insecure-document-method.insecure-document-method", "subcategory": ["audit"], "technology": ["browser"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$EL": {"abstract_content": "document.body", "end": {"col": 14, "line": 2, "offset": 55}, "start": {"col": 1, "line": 2, "offset": 42}}, "$HTML": {"abstract_content": "userInput", "end": {"col": 36, "line": 2, "offset": 77}, "propagated_value": {"svalue_abstract_content": "location.hash.slice(1)", "svalue_end": {"col": 41, "line": 1, "offset": 40}, "svalue_start": {"col": 19, "line": 1, "offset": 18}}, "start": {"col": 27, "line": 2, "offset": 68}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/index.js", "start": {"col": 1, "line": 2, "offset": 42}}, {"check_id": "javascript.browser.security.insecure-document-method.insecure-document-method", "end": {"col": 36, "line": 10, "offset": 244}, "extra": {"engine_kind": "OSS", "fingerprint": "a9bd8be636516316b1600cd843e14b1972b71a2cdb47fc0a09da514ba9a5ec2f0d6c598b885a0db3c2f6fbea9ee1c518f16a223ead32d6347b3dbbaf28b11bf8_0", "is_ignored": false, "lines": "    document.body.innerHTML = html;", "message": "User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9239, "rule_id": "ReUg41", "rv_id": 945779, "url": "https://semgrep.dev/playground/r/zyTlk9P/javascript.browser.security.insecure-document-method.insecure-document-method", "version_id": "zyTlk9P"}}, "shortlink": "https://sg.run/LwA9", "source": "https://semgrep.dev/r/javascript.browser.security.insecure-document-method.insecure-document-method", "subcategory": ["audit"], "technology": ["browser"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$EL": {"abstract_content": "document.body", "end": {"col": 18, "line": 10, "offset": 226}, "start": {"col": 5, "line": 10, "offset": 213}}, "$HTML": {"abstract_content": "html", "end": {"col": 35, "line": 10, "offset": 243}, "propagated_value": {"svalue_abstract_content": "`<div>data.name</div>", "svalue_end": {"col": 42, "line": 9, "offset": 206}, "svalue_start": {"col": 18, "line": 9, "offset": 182}}, "start": {"col": 31, "line": 10, "offset": 239}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/index.js", "start": {"col": 5, "line": 10, "offset": 213}}, {"check_id": "python.lang.security.deserialization.pickle.avoid-pickle", "end": {"col": 39, "line": 22, "offset": 580}, "extra": {"engine_kind": "OSS", "fingerprint": "b8cee3c77e00a2b68e46f4790683852f3ff1974ca88663d9b0d17b12580248ba41889b8b2978c92a6ed8b71845591217aad118fcb3efafdb810011ec1146b80a_0", "is_ignored": false, "lines": "            self.data = pickle.load(f)", "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-502: Deserialization of Untrusted Data"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A08:2017 - Insecure Deserialization", "A08:2021 - Software and Data Integrity Failures"], "references": ["https://docs.python.org/3/library/pickle.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9675, "rule_id": "EwU2BJ", "rv_id": 946397, "url": "https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle", "version_id": "w8TKJL9"}}, "shortlink": "https://sg.run/OPwB", "source": "https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle", "subcategory": ["audit"], "technology": ["python"], "vulnerability_class": ["Insecure Deserialization "]}, "metavars": {"$FUNC": {"abstract_content": "load", "end": {"col": 36, "line": 22, "offset": 577}, "start": {"col": 32, "line": 22, "offset": 573}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/security_issues.py", "start": {"col": 25, "line": 22, "offset": 566}}, {"check_id": "python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "end": {"col": 63, "line": 27, "offset": 797}, "extra": {"engine_kind": "OSS", "fingerprint": "40164099ef872bc5d68a347246816d344760ef8dc5537c0d0e0f1a329ec3160efb2af8b16d15b041f933a43e0b19cc9efaa79c9641882e8d692ff0f3d4cb5b3a_0", "fix": "False", "is_ignored": false, "lines": "        result = subprocess.run(f\"ls {user_input}\", shell=True, capture_output=True)", "message": "Found 'subprocess' function 'run' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess", "https://docs.python.org/3/library/subprocess.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9646, "rule_id": "DbUpz2", "rv_id": 946382, "url": "https://semgrep.dev/playground/r/YDTvReW/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "version_id": "YDTvReW"}}, "shortlink": "https://sg.run/J92w", "source": "https://semgrep.dev/r/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html", "subcategory": ["secure default"], "technology": ["python"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$FUNC": {"abstract_content": "run", "end": {"col": 32, "line": 27, "offset": 766}, "start": {"col": 29, "line": 27, "offset": 763}}, "$TRUE": {"abstract_content": "True", "end": {"col": 63, "line": 27, "offset": 797}, "start": {"col": 59, "line": 27, "offset": 793}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/security_issues.py", "start": {"col": 59, "line": 27, "offset": 793}}, {"check_id": "python.lang.security.audit.eval-detected.eval-detected", "end": {"col": 27, "line": 55, "offset": 1627}, "extra": {"engine_kind": "OSS", "fingerprint": "69c12f0fd16c4c7fa9adce389c2b1a0c1f26fc6cc90a9956d921ede672e1f81bb982a90fd81850fba9b931547c61ccef7907a2419f69567bfd100011b1603b99_0", "is_ignored": false, "lines": "    return eval(user_code)", "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.", "metadata": {"asvs": {"control_id": "5.2.4 Dyanmic Code Execution Features", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "HIGH", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9635, "rule_id": "gxU149", "rv_id": 946341, "url": "https://semgrep.dev/playground/r/xyTqnr7/python.lang.security.audit.eval-detected.eval-detected", "version_id": "xyTqnr7"}}, "shortlink": "https://sg.run/ZvrD", "source": "https://semgrep.dev/r/python.lang.security.audit.eval-detected.eval-detected", "source-rule-url": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval", "subcategory": ["audit"], "technology": ["python"], "vulnerability_class": ["Code Injection"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/security_issues.py", "start": {"col": 12, "line": 55, "offset": 1612}}, {"check_id": "python.lang.security.deserialization.pickle.avoid-pickle", "end": {"col": 31, "line": 8, "offset": 210}, "extra": {"engine_kind": "OSS", "fingerprint": "a4f95bdb0b9a0c92a9629af718b1ede28ff1a8f5c6092118ef411ba60bd676c6ce86c70c4552b2883100468fe621b5f7bf48535b7801b6b1216fe9d39430a73b_0", "is_ignored": false, "lines": "        users = pickle.load(f)", "message": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-502: Deserialization of Untrusted Data"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A08:2017 - Insecure Deserialization", "A08:2021 - Software and Data Integrity Failures"], "references": ["https://docs.python.org/3/library/pickle.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9675, "rule_id": "EwU2BJ", "rv_id": 946397, "url": "https://semgrep.dev/playground/r/w8TKJL9/python.lang.security.deserialization.pickle.avoid-pickle", "version_id": "w8TKJL9"}}, "shortlink": "https://sg.run/OPwB", "source": "https://semgrep.dev/r/python.lang.security.deserialization.pickle.avoid-pickle", "subcategory": ["audit"], "technology": ["python"], "vulnerability_class": ["Insecure Deserialization "]}, "metavars": {"$FUNC": {"abstract_content": "load", "end": {"col": 28, "line": 8, "offset": 207}, "start": {"col": 24, "line": 8, "offset": 203}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/user_api.py", "start": {"col": 17, "line": 8, "offset": 196}}, {"check_id": "python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "end": {"col": 35, "line": 10, "offset": 285}, "extra": {"engine_kind": "OSS", "fingerprint": "e47a97e78d7e48f34efc3de738cc11563b0d40940cb50154483f4da788e5ec89065e4a8a00eacd2697d9f2a46c2f5797e4ca3dd17249416d95bd2ab6e1fb6b9c_0", "fix": "False", "is_ignored": false, "lines": "    subprocess.run(cmd, shell=True)", "message": "Found 'subprocess' function 'run' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "HIGH", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess", "https://docs.python.org/3/library/subprocess.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9646, "rule_id": "DbUpz2", "rv_id": 946382, "url": "https://semgrep.dev/playground/r/YDTvReW/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "version_id": "YDTvReW"}}, "shortlink": "https://sg.run/J92w", "source": "https://semgrep.dev/r/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true", "source-rule-url": "https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html", "subcategory": ["secure default"], "technology": ["python"], "vulnerability_class": ["Command Injection"]}, "metavars": {"$FUNC": {"abstract_content": "run", "end": {"col": 19, "line": 10, "offset": 269}, "start": {"col": 16, "line": 10, "offset": 266}}, "$TRUE": {"abstract_content": "True", "end": {"col": 35, "line": 10, "offset": 285}, "start": {"col": 31, "line": 10, "offset": 281}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/user_api.py", "start": {"col": 31, "line": 10, "offset": 281}}, {"check_id": "python.lang.security.audit.eval-detected.eval-detected", "end": {"col": 24, "line": 24, "offset": 627}, "extra": {"engine_kind": "OSS", "fingerprint": "80f2bcd7d7942c955e26fdc811a088b23735ade8c7197e8165edb0562a5a9ffdd15fbcaf68def6446574b2d7bb031ff5ff535059e848bce202abaad0fe40324d_0", "is_ignored": false, "lines": "    result = eval(data)", "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.", "metadata": {"asvs": {"control_id": "5.2.4 Dyanmic Code Execution Features", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements", "section": "V5: Validation, Sanitization and Encoding Verification Requirements", "version": "4"}, "category": "security", "confidence": "LOW", "cwe": ["CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"], "impact": "HIGH", "license": "Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9635, "rule_id": "gxU149", "rv_id": 946341, "url": "https://semgrep.dev/playground/r/xyTqnr7/python.lang.security.audit.eval-detected.eval-detected", "version_id": "xyTqnr7"}}, "shortlink": "https://sg.run/ZvrD", "source": "https://semgrep.dev/r/python.lang.security.audit.eval-detected.eval-detected", "source-rule-url": "https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval", "subcategory": ["audit"], "technology": ["python"], "vulnerability_class": ["Code Injection"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "/workspaces/cra/Examples/user_api.py", "start": {"col": 14, "line": 24, "offset": 617}}], "skipped_rules": [], "version": "1.85.0"}

```

## jscpd Output

```
No output or errors occurred.
```

---


---
*Report generated by CRA*
